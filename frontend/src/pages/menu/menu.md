# èœå•ç®¡ç†é¡µé¢è¯¦ç»†è®¾è®¡æ–‡æ¡£ï¼ˆæœ€ç»ˆç‰ˆ - å·¦å³ç»“æ„ï¼Œæ— æ‹–æ‹½ï¼‰

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** 1.3  
**æœ€åæ›´æ–°ï¼š** 2025å¹´9æœˆ8æ—¥  
**ä½œè€…ï¼š** Qwenï¼ˆåŸºäº Alibaba Cloudï¼‰  
**é€‚ç”¨ç³»ç»Ÿï¼š** äºšæ´²ä¿¡æ¯ç»¼åˆç®¡ç†ç³»ç»Ÿï¼ˆSynthï¼‰  
**ç›®æ ‡æ¨¡å—ï¼š** èœå•ç®¡ç†ï¼ˆMenu Managementï¼‰

---

## 1. æ¦‚è¿°

æœ¬æ–‡æ¡£ä¸ºâ€œèœå•ç®¡ç†â€åŠŸèƒ½æ¨¡å—çš„**æœ€ç»ˆç‰ˆå‰ç«¯è®¾è®¡æ–‡æ¡£**ï¼ŒåŸºäºæœ€æ–°çš„ `MenuController` æ¥å£è§„èŒƒï¼Œé‡‡ç”¨**å·¦å³å¸ƒå±€ç»“æ„**ï¼Œå·¦ä¾§ä¸ºæ ‘å½¢èœå•å¯¼èˆªï¼Œå³ä¾§ä¸Šéƒ¨ä¸ºè¡¨å•è¿‡æ»¤åŒºï¼Œä¸‹éƒ¨ä¸ºè¡¨æ ¼å±•ç¤ºåŒºã€‚**å·²ç§»é™¤æ‹–æ‹½æ’åºä¸å±‚çº§è°ƒæ•´åŠŸèƒ½**ï¼Œé€šè¿‡è¡¨å•å­—æ®µè®¾ç½®çˆ¶çº§å’Œé¡ºåºï¼Œæå‡æ“ä½œæ˜ç¡®æ€§ä¸ç³»ç»Ÿç¨³å®šæ€§ã€‚

### æ ¸å¿ƒç‰¹æ€§
- âœ… **å·¦å³ç»“æ„å¸ƒå±€**ï¼šå·¦æ ‘å³è¡¨ï¼Œæ¸…æ™°åˆ†åŒº
- âœ… **å·¦ä¾§æ ‘å½¢å¯¼èˆª**ï¼šå±•ç¤ºå®Œæ•´èœå•å±‚çº§ï¼Œæ”¯æŒå±•å¼€/æŠ˜å 
- âœ… **å³ä¾§åŒåŒºè®¾è®¡**ï¼šä¸Šéƒ¨è¿‡æ»¤è¡¨å•ï¼Œä¸‹éƒ¨æ•°æ®è¡¨æ ¼
- âœ… **æ— æ‹–æ‹½äº¤äº’**ï¼šé€šè¿‡â€œçˆ¶çº§èœå•â€é€‰æ‹©æ¡†å’Œâ€œæ’åºå·â€å­—æ®µç®¡ç†å±‚çº§ä¸é¡ºåº
- âœ… **è§’è‰²æƒé™ç®¡ç†**ï¼šåˆ†é…ã€ç§»é™¤ã€æ›¿æ¢
- âœ… **ç”¨æˆ·æƒé™æ ¡éªŒ**ï¼šæ”¯æŒå•ä¸ªã€URLã€æ‰¹é‡æƒé™æ£€æŸ¥
- âœ… **æŒ‰é’®çº§æƒé™æ§åˆ¶**ï¼šç‹¬ç«‹å±•ç¤ºä¸ç®¡ç†
- âœ… **å®Œå–„çš„æ•°æ®æ¥å£æ”¯æŒ**

---

## 2. æ•°æ®æ¨¡å‹

> ä¿æŒä¸å˜ï¼ˆä¸åç«¯ DTO å®šä¹‰å®Œå…¨ä¸€è‡´ï¼‰

### 2.1 æ ¸å¿ƒå®ä½“
- `MenuCreateDto`ï¼šåˆ›å»ºèœå•
- `MenuUpdateDto`ï¼šæ›´æ–°èœå•
- `MenuDto`ï¼šèœå•è¯¦æƒ…
- `MenuTreeDto`ï¼šæ ‘å½¢ç»“æ„
- `RoleMenuRelaDto`ï¼šè§’è‰²èœå•å…³è”

> **è¯´æ˜ï¼š** æ‰€æœ‰å­—æ®µå®šä¹‰ä¸ `dto` åŒ…ä¸­ç±»ä¸€è‡´ï¼Œæ­¤å¤„ä¸å†é‡å¤ã€‚

---

## 3. æ¥å£è§„èŒƒï¼ˆåŸºäº `MenuController`ï¼‰

| åŠŸèƒ½ | HTTP æ–¹æ³• | è·¯å¾„ | è¯·æ±‚ä½“ | å“åº”ä½“ |
|------|----------|------|--------|--------|
| åˆ›å»ºèœå• | `POST` | `/api/menu` | `MenuCreateDto` | `{success, message, data: MenuDto}` |
| è·å–èœå•è¯¦æƒ… | `GET` | `/api/menu/{menuId}` | - | `{success, message, data: MenuDto}` |
| æ ¹æ®åç§°è·å–èœå• | `GET` | `/api/menu/name/{menuName}` | - | `{success, message, data: MenuDto}` |
| åˆ†é¡µæŸ¥è¯¢èœå• | `GET` | `/api/menu` | æŸ¥è¯¢å‚æ•° | `{success, message, data: List<MenuDto>, totalElements, totalPages, currentPage, pageSize}` |
| æ›´æ–°èœå• | `POST` | `/api/menu/{menuId}/update` | `MenuUpdateDto` | `{success, message, data: MenuDto}` |
| åˆ é™¤èœå• | `POST` | `/api/menu/{menuId}` | - | `{success, message}` |
| æ‰¹é‡åˆ é™¤èœå• | `POST` | `/api/menu/batch` | `List<String>` | `{success, message, data: {deletedCount, totalCount}}` |
| å¯ç”¨èœå• | `POST` | `/api/menu/{menuId}/enable` | - | `{success, message}` |
| ç¦ç”¨èœå• | `POST` | `/api/menu/{menuId}/disable` | - | `{success, message}` |
| è·å–èœå•æ ‘ | `GET` | `/api/menu/tree` | - | `{success, message, data: List<MenuTreeDto>}` |
| è·å–æ ¹èœå• | `GET` | `/api/menu/root` | - | `{success, message, data: List<MenuDto>}` |
| è·å–å­èœå• | `GET` | `/api/menu/{parentId}/children` | - | `{success, message, data: List<MenuDto>}` |
| è·å–æ‰€æœ‰å­èœå•ï¼ˆé€’å½’ï¼‰ | `GET` | `/api/menu/{parentId}/all-children` | - | `{success, message, data: List<MenuDto>}` |
| åˆ†é…èœå•æƒé™ | `POST` | `/api/menu/role/{roleId}/assign` | `List<String>` | `{success, message, data: {assignedCount, totalCount}}` |
| ç§»é™¤èœå•æƒé™ | `POST` | `/api/menu/role/{roleId}/remove` | `List<String>` | `{success, message, data: {removedCount, totalCount}}` |
| æ›¿æ¢è§’è‰²èœå•æƒé™ | `POST` | `/api/menu/role/{roleId}/replace` | `List<String>` | `{success, message}` |
| è·å–è§’è‰²èœå•åˆ—è¡¨ | `GET` | `/api/menu/role/{roleId}` | - | `{success, message, data: List<MenuDto>}` |
| è·å–è§’è‰²èœå•æ ‘ | `GET` | `/api/menu/role/{roleId}/tree` | - | `{success, message, data: List<MenuTreeDto>}` |
| è·å–èœå•å…³è”è§’è‰² | `GET` | `/api/menu/{menuId}/roles` | - | `{success, message, data: List<RoleMenuRelaDto>}` |
| è·å–ç”¨æˆ·èœå•åˆ—è¡¨ | `GET` | `/api/menu/user/{userId}` | - | `{success, message, data: List<MenuDto>}` |
| è·å–ç”¨æˆ·èœå•æ ‘ | `GET` | `/api/menu/user/{userId}/tree` | - | `{success, message, data: List<MenuTreeDto>}` |
| æ£€æŸ¥ç”¨æˆ·èœå•æƒé™ | `GET` | `/api/menu/user/{userId}/permission/{menuId}` | - | `{success, message, data: {hasPermission}}` |
| æ£€æŸ¥ç”¨æˆ·URLæƒé™ | `GET` | `/api/menu/user/{userId}/url-permission?url=xxx` | - | `{success, message, data: {hasPermission, url}}` |
| æ‰¹é‡æ£€æŸ¥ç”¨æˆ·æƒé™ | `POST` | `/api/menu/user/{userId}/batch-permission` | `List<String>` | `{success, message, data: Map<String, Boolean>}` |
| è·å–èœå•ä¸‹æŒ‰é’® | `GET` | `/api/menu/{parentMenuId}/buttons` | - | `{success, message, data: List<MenuDto>}` |
| è·å–ç”¨æˆ·æŒ‰é’®æƒé™ | `GET` | `/api/menu/user/{userId}/menu/{parentMenuId}/buttons` | - | `{success, message, data: List<MenuDto>}` |
| æ£€æŸ¥èœå•IDæ˜¯å¦å­˜åœ¨ | `GET` | `/api/menu/check/id/{menuId}` | - | `{success, message, data: {exists, menuId}}` |
| æ£€æŸ¥èœå•åç§°æ˜¯å¦å­˜åœ¨ | `GET` | `/api/menu/check/name/{menuName}` | - | `{success, message, data: {exists, menuName}}` |

---

## 4. é¡µé¢ç»“æ„è®¾è®¡ï¼ˆæœ€ç»ˆç‰ˆï¼‰

> **å¸ƒå±€è¯´æ˜ï¼š**
> - **æ•´ä½“å®½åº¦æ¯”ä¾‹**ï¼šå·¦ä¾§æ ‘åŒºåŸŸå  30%ï¼Œå³ä¾§å†…å®¹åŒºå  70%
> - **å³ä¾§åˆ†ä¸Šä¸‹ä¸¤éƒ¨åˆ†**ï¼šä¸Šéƒ¨è¿‡æ»¤è¡¨å•é«˜åº¦çº¦ 120pxï¼Œä¸‹éƒ¨è¡¨æ ¼å æ®å‰©ä½™ç©ºé—´

```
+---------------------------------------------------+
| èœå•ç®¡ç†                                           |
+-----------------------------+---------------------+
|                             | [æ–°å¢] [åˆ·æ–°] [å¯¼å‡º] |
|         èœå•æ ‘åŒºåŸŸ           |                     |
|                             |  è¿‡æ»¤è¡¨å•åŒºåŸŸ        |
|  â”œâ”€â”€ ç³»ç»Ÿç®¡ç† (MENU)         |  - èœå•åç§°è¾“å…¥æ¡†     |
|  â”‚   â”œâ”€â”€ ç”¨æˆ·ç®¡ç† (MENU)     |  - èœå•ç±»å‹é€‰æ‹©       |
|  â”‚   â”‚   â””â”€â”€ æ–°å¢ç”¨æˆ· (BUTTON)|  - çŠ¶æ€é€‰æ‹©ï¼ˆå¯ç”¨/ç¦ç”¨ï¼‰|
|  â”‚   â””â”€â”€ è§’è‰²ç®¡ç† (MENU)     |  - [æŸ¥è¯¢] [é‡ç½®]     |
|  â””â”€â”€ ç›‘æ§ä¸­å¿ƒ (DIRECTORY)    |                     |
|      â””â”€â”€ å®æ—¶ç›‘æ§ (MENU)     |                     |
|  [å±•å¼€å…¨éƒ¨] [æŠ˜å å…¨éƒ¨]       +---------------------+
|  [æœç´¢æ ‘èŠ‚ç‚¹...]             | è¡¨æ ¼å±•ç¤ºåŒºåŸŸ          |
|                             |                       |
|                             | åºå· | èœå•åç§° | ç±»å‹  |
|                             | ...  | ...     | ...   |
|                             |                       |
|                             | [åˆ†é¡µæ§ä»¶]            |
+-----------------------------+---------------------+
```

### 4.1 å·¦ä¾§èœå•æ ‘ï¼ˆTree Panelï¼‰
- **åŠŸèƒ½ï¼š**
  - å±•ç¤ºå®Œæ•´çš„èœå•å±‚çº§ç»“æ„
  - æ”¯æŒå±•å¼€/æŠ˜å èŠ‚ç‚¹
  - ç‚¹å‡»èŠ‚ç‚¹åï¼Œå³ä¾§è¡¨æ ¼ä»…å±•ç¤ºè¯¥èŠ‚ç‚¹åŠå…¶æ‰€æœ‰å­èŠ‚ç‚¹çš„èœå•ä¿¡æ¯ï¼ˆè°ƒç”¨ `/all-children` æ¥å£ï¼‰
  - ç‚¹å‡»æ ¹èŠ‚ç‚¹æˆ–ç©ºç™½åŒºåŸŸå¯é‡ç½®ä¸ºå±•ç¤ºå…¨éƒ¨èœå•
- **äº¤äº’å¢å¼ºï¼š**
  - æä¾›â€œå±•å¼€å…¨éƒ¨â€ã€â€œæŠ˜å å…¨éƒ¨â€å¿«æ·æ“ä½œæŒ‰é’®
  - æ”¯æŒæ ‘èŠ‚ç‚¹æœç´¢ï¼ˆè¾“å…¥å…³é”®å­—é«˜äº®åŒ¹é…èŠ‚ç‚¹ï¼‰
- **æ•°æ®æ¥æºï¼š** `GET /api/menu/tree`
- **çŠ¶æ€å˜é‡ï¼š** `selectedTreeNodeId`

### 4.2 å³ä¾§ä¸Šéƒ¨ - è¿‡æ»¤è¡¨å•ï¼ˆFilter Formï¼‰
- **å­—æ®µï¼š**
  - **èœå•åç§°**ï¼šæ–‡æœ¬è¾“å…¥ï¼Œæ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢
  - **èœå•ç±»å‹**ï¼šä¸‹æ‹‰é€‰æ‹©ï¼ˆå…¨éƒ¨ã€ç›®å½•ã€èœå•ã€æŒ‰é’®ï¼‰
  - **çŠ¶æ€**ï¼šä¸‹æ‹‰é€‰æ‹©ï¼ˆå…¨éƒ¨ã€å¯ç”¨ã€ç¦ç”¨ï¼‰
- **æ“ä½œæŒ‰é’®ï¼š**
  - ã€æŸ¥è¯¢ã€‘ï¼šæ ¹æ®è¡¨å•æ¡ä»¶å’Œå½“å‰é€‰ä¸­èŠ‚ç‚¹è¿›è¡Œç­›é€‰
  - ã€é‡ç½®ã€‘ï¼šæ¸…ç©ºè¡¨å•ï¼Œé‡ç½®ä¸ºåˆå§‹çŠ¶æ€
- **é€»è¾‘ï¼š**
  - æŸ¥è¯¢æ¡ä»¶ä¸å·¦ä¾§æ ‘é€‰ä¸­èŠ‚ç‚¹**å åŠ ç”Ÿæ•ˆ**
  - è‹¥æœªé€‰ä¸­ä»»ä½•èŠ‚ç‚¹ï¼Œåˆ™é»˜è®¤æŸ¥è¯¢æ‰€æœ‰èœå•
- **æ•°æ®æ¥æºï¼š** `GET /api/menu`ï¼ˆå¸¦æŸ¥è¯¢å‚æ•°ï¼‰

### 4.3 å³ä¾§ä¸‹éƒ¨ - è¡¨æ ¼å±•ç¤ºï¼ˆTable Panelï¼‰
- **åˆ—ä¿¡æ¯ï¼š**
  | åˆ—å | å­—æ®µ | è¯´æ˜ |
  |------|------|------|
  | åºå· | index | è‡ªåŠ¨ç”Ÿæˆ |
  | èœå•åç§° | menuName | é«˜äº®æ˜¾ç¤ºåŒ¹é…å…³é”®è¯ |
  | èœå•ID | menuId | - |
  | èœå•ç±»å‹ | menuType | å›¾æ ‡åŒºåˆ†ï¼šğŸ“ç›®å½•ã€ğŸ“„èœå•ã€ğŸ”˜æŒ‰é’® |
  | è·¯ç”±è·¯å¾„ | path | ä»…èœå•ç±»å‹æ˜¾ç¤º |
  | ç»„ä»¶è·¯å¾„ | component | ä»…èœå•ç±»å‹æ˜¾ç¤º |
  | å›¾æ ‡ | icon | å›¾æ ‡é¢„è§ˆ |
  | çŠ¶æ€ | status | æ–‡æœ¬ï¼šå¯ç”¨/ç¦ç”¨ |
  | æ’åºå· | seq | æ•°å­— |
  | æ“ä½œ | actions | ç¼–è¾‘ã€åˆ é™¤ã€å¯ç”¨/ç¦ç”¨ã€æƒé™åˆ†é… |

- **åŠŸèƒ½ï¼š**
  - åˆ†é¡µå±•ç¤ºï¼ˆæ¯é¡µ10/20/50æ¡ï¼Œå¯é…ç½®ï¼‰
  - â€œç¼–è¾‘â€å¼¹å‡ºæ¨¡æ€æ¡†ä¿®æ”¹èœå•ä¿¡æ¯
  - â€œåˆ é™¤â€éœ€äºŒæ¬¡ç¡®è®¤ï¼Œè°ƒç”¨åˆ é™¤æ¥å£
  - â€œå¯ç”¨/ç¦ç”¨â€åˆ‡æ¢çŠ¶æ€å¹¶å®æ—¶åˆ·æ–°
  - â€œæƒé™åˆ†é…â€è·³è½¬è‡³è§’è‰²æƒé™åˆ†é…é¡µé¢æˆ–å¼¹çª—
- **æ•°æ®æ¥æºï¼š** `GET /api/menu`ï¼ˆåˆ†é¡µ + æŸ¥è¯¢å‚æ•°ï¼‰

---

## 5. æ ¸å¿ƒåŠŸèƒ½è®¾è®¡

### 5.1 å±‚çº§ä¸é¡ºåºç®¡ç†ï¼ˆæ›¿ä»£æ‹–æ‹½ï¼‰
- **çˆ¶çº§èœå•è®¾ç½®**ï¼šåœ¨åˆ›å»º/ç¼–è¾‘è¡¨å•ä¸­æä¾›â€œçˆ¶çº§èœå•â€ä¸‹æ‹‰é€‰æ‹©æ¡†ï¼Œä»æ ‘ç»“æ„ä¸­é€‰æ‹©
- **æ’åºå·è®¾ç½®**ï¼šæ‰‹åŠ¨è¾“å…¥æ•°å­—ï¼Œæ•°å€¼è¶Šå°æ’åºè¶Šé å‰
- **ä¼˜åŠ¿**ï¼šæ“ä½œæ˜ç¡®ï¼Œé¿å…è¯¯æ“ä½œï¼Œé™ä½å‰åç«¯å¤æ‚åº¦

### 5.2 èœå•åˆ›å»ºä¸ç¼–è¾‘
- **æ‰“å¼€æ–¹å¼ï¼š**
  - ç‚¹å‡»ã€æ–°å¢ã€‘æŒ‰é’® â†’ å¼¹å‡ºåˆ›å»ºè¡¨å•
  - è¡¨æ ¼ä¸­ç‚¹å‡»ã€ç¼–è¾‘ã€‘ â†’ å¼¹å‡ºç¼–è¾‘è¡¨å•
- **å…³é”®å­—æ®µï¼š**
  - çˆ¶çº§èœå•ï¼ˆå¿…å¡«ï¼‰
  - æ’åºå·ï¼ˆå¿…å¡«ï¼Œé»˜è®¤ä¸º999ï¼‰
- **æ ¡éªŒï¼š**
  - åˆ›å»ºæ—¶è°ƒç”¨ï¼š
    - `GET /api/menu/check/id/{menuId}` â†’ é˜²æ­¢IDé‡å¤
    - `GET /api/menu/check/name/{menuName}` â†’ é˜²æ­¢åç§°é‡å¤

---

## 6. é¡µé¢äº¤äº’æµç¨‹

### 6.1 åˆå§‹åŒ–åŠ è½½
```mermaid
sequenceDiagram
    participant Frontend
    participant Backend
    Frontend->>Backend: GET /api/menu/tree
    Backend-->>Frontend: List<MenuTreeDto>
    Frontend->>Frontend: æ¸²æŸ“å·¦ä¾§èœå•æ ‘
    Frontend->>Backend: GET /api/menu?page=1&size=10
    Backend-->>Frontend: åˆ†é¡µèœå•åˆ—è¡¨
    Frontend->>Frontend: æ¸²æŸ“å³ä¾§è¡¨æ ¼
```

### 6.2 æ ‘èŠ‚ç‚¹ç‚¹å‡»
```mermaid
sequenceDiagram
    participant Frontend
    participant Backend
    Frontend->>Frontend: ç”¨æˆ·ç‚¹å‡»å·¦ä¾§æ ‘èŠ‚ç‚¹
    Frontend->>Backend: GET /api/menu/{parentId}/all-children
    Backend-->>Frontend: List<MenuDto>
    Frontend->>Frontend: æ¸²æŸ“å³ä¾§è¡¨æ ¼ï¼ˆä»…å­èœå•ï¼‰
```

### 6.3 è¡¨å•æŸ¥è¯¢
```mermaid
sequenceDiagram
    participant Frontend
    participant Backend
    Frontend->>Frontend: ç”¨æˆ·å¡«å†™è¿‡æ»¤æ¡ä»¶å¹¶ç‚¹å‡»ã€æŸ¥è¯¢ã€‘
    Frontend->>Backend: GET /api/menu?menuName=xxx&type=MENU&status=ENABLED&parentId=selectedId
    Backend-->>Frontend: åˆ†é¡µèœå•åˆ—è¡¨
    Frontend->>Frontend: æ¸²æŸ“å³ä¾§è¡¨æ ¼
```

---

## 7. çŠ¶æ€ç®¡ç†

- `menuTree`: å­˜å‚¨èœå•æ ‘æ•°æ®
- `selectedTreeNodeId`: å½“å‰é€‰ä¸­çš„æ ‘èŠ‚ç‚¹ID
- `filterForm`: { menuName, menuType, status }
- `tableData`: å½“å‰è¡¨æ ¼å±•ç¤ºçš„æ•°æ®åˆ—è¡¨
- `pagination`: { page, size, total }

---

## 8. å¼‚å¸¸å¤„ç†

| é”™è¯¯ç±»å‹ | å¤„ç†æ–¹å¼ |
|---------|----------|
| æ ¡éªŒå¤±è´¥ | å‰ç«¯çº¢æ¡†æç¤º + å…·ä½“æ¶ˆæ¯ |
| menuId é‡å¤ | è°ƒç”¨ `/check/id` æå‰æ ¡éªŒ |
| åç§°é‡å¤ | è°ƒç”¨ `/check/name` æå‰æ ¡éªŒ |
| æ¥å£è¶…æ—¶ | æç¤ºâ€œç½‘ç»œå¼‚å¸¸ï¼Œè¯·é‡è¯•â€ |
| æƒé™ä¸è¶³ | ç¦ç”¨æ“ä½œæŒ‰é’®ï¼Œæç¤ºâ€œæ— æƒé™â€ |

---

## 9. ä¼˜åŒ–å»ºè®®

1. **å‰ç«¯ç¼“å­˜**ï¼šç¼“å­˜ `/api/menu/tree` ç»“æœï¼Œå‡å°‘è¯·æ±‚
2. **æ‡’åŠ è½½**ï¼šå¤§èœå•æ ‘å¯è€ƒè™‘æŒ‰éœ€åŠ è½½å­èŠ‚ç‚¹
3. **UI å¢å¼º**ï¼šè¡¨æ ¼è¡Œ hover æ•ˆæœã€æ“ä½œåˆ—æŒ‰é’®å›¾æ ‡åŒ–
4. **å¿«æ·æ“ä½œ**ï¼šæ”¯æŒé”®ç›˜æ“ä½œï¼ˆå¦‚ Enter æŸ¥è¯¢ï¼ŒEsc å…³é—­å¼¹çª—ï¼‰

---